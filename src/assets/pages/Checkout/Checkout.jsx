import React, { useEffect, useRef, useState } from "react";
import "./checkout.scss";
import { useDispatch, useSelector } from "react-redux";
import { uiActions } from "../../../store/slices/ui-slice";
import { restaurantActions } from "../../../store/slices/restaurants-slice";
import CartItem from "../RestaurantDetails/CartiItem";
import DarkButton from "../../components/Buttons/DarkButton";
import { useNavigate, useParams } from "react-router-dom";
import {
  addItemToCart,
  fetchRestaurantById,
  getCartItems,
} from "../../../util/http";
import { set } from "lodash";
import { useQueries, useQuery } from "@tanstack/react-query";
import animationData from "../../lotties/paymentSuccess.json";
import Lottie from "react-lottie";

const Checkout = () => {
  const loaderOptions = {
    loop: false,
    autoplay: true,
    animationData: animationData,
    rendererSettings: {
      preserveAspectRatio: "xMidYMid slice",
    },
  };

  const navigate = useNavigate();

  const [name, setName] = useState("");
  const [email, setEmail] = useState("");
  const [number, setNumber] = useState("");
  const params = useParams();
  const [cart, setCart] = useState({ items: [] });
  const { data, isPending, isError, error } = useQuery({
    queryKey: ["restaurant-details", params.restaurantId],
    queryFn: () => fetchRestaurantById(params.restaurantId),
  });

  const [userDetails, setUserDetails] = useState(true);
  const [pickup, setPickup] = useState(false);
  const [payment, setPayment] = useState(false);

  const isLoggedIn = useSelector((state) => state.ui.isLoggedIn);

  const dispatch = useDispatch();
  const [checkout, setCheckout] = useState(false);

  const [isCard, setIsCard] = useState();
  const [isPaypal, setIsPaypal] = useState();
  const [paymentDone, setPaymentDone] = useState(false);

  const emailRef = useRef();
  const phoneRef = useRef();
  const nameRef = useRef();
  const paypalRef = useRef();
  const cardRef = useRef();

  const theCart = useSelector((state) => state.restaurants.cart);

  const [total, setTotal] = useState(0);

  const handleNameChange = (e) => {
    setName(e.target.value);
    checkValidations(false, (valid) => {
      console.log("IsValidThing", valid);
      setCheckout(valid);
    });
  };

  function calculatePrice(cartItem) {
    let price = cartItem.price * cartItem.quantity;
    let subPrice = 0;
    if (cartItem.modifiers)
      cartItem.modifiers.items.forEach((item) => {
        console.log("ItemY", item);
        item.items.forEach((item) => {
          if (item.isChecked) {
            let thePrice = 0;
            if (item.price) {
              thePrice = item.price;
            }
            subPrice += thePrice;
          }
        });
      });
    price += subPrice;
    return price;
  }

  function calculateTotal(cartItem) {
    let price = 0;
    cartItem.items.forEach((element) => {
      price += calculatePrice(element);
    });
    return price.toFixed(2);
  }

  useEffect(() => {
    dispatch(uiActions.setShow({ visible: true }));
    dispatch(uiActions.setNavStatic({ visible: true }));
    dispatch(
      restaurantActions.setCurrentMenu({
        id: 1,
      })
    );

    console.log("gettingCart");
    getCartItems(params.restaurantId, (data) => {
      console.log("OnData", data);
      setCart({ ...data });
    });

    const user = JSON.parse(localStorage.getItem("user"));

    setName(user.name);
    setEmail(user.email);

    if (user.phone) {
      setNumber(user.phone);
    }
  }, []);

  const handleEmailChange = (e) => {
    setEmail(e.target.value);
    checkValidations(false, (valid) => {
      console.log("IsValidThing", valid);
      setCheckout(valid);
    });
  };

  const handleNumberChange = (e) => {
    setNumber(e.target.value);
    checkValidations(false, (valid) => {
      console.log("IsValidThing", valid);
      setCheckout(valid);
    });
  };

  function checkValidations(isFromCheckBox, onValid) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const phoneRegex = /^\d{10}$/;

    console.log("UserDetails:");
    console.log(email);
    console.log(number);
    console.log(name);

    if (!emailRegex.test(emailRef.current.value)) {
      console.log("Invalid email");
      onValid(false);
      return;
    }

    if (nameRef.current.value.trim() === "") {
      console.log("Invalid password");
      onValid(false);
      return;
    }

    if (!phoneRegex.test(phoneRef.current.value)) {
      console.log("Invalid phone number");
      onValid(false);
      return;
    }

    if (isFromCheckBox) {
      onValid(true);
      return;
    } else {
      if (paypalRef.current.checked) {
        onValid(true);
        return;
      }

      if (cardRef.current.checked) {
        onValid(true);
        return;
      } else {
        onValid(false);
        return;
      }
    }
  }

  function handleOnCardClick() {
    setIsCard(true);
    setIsPaypal(false);
    checkValidations(true, (valid) => {
      console.log("IsValidThing", valid);
      setCheckout(valid);
    });
  }

  function handleOnPayPal() {
    setIsPaypal(true);
    setIsCard(false);
    checkValidations(true, (valid) => {
      console.log("IsValidThing", valid);
      setCheckout(valid);
    });
  }

  function onPlaceOrder() {
    setPaymentDone(true);

    dispatch(restaurantActions.clearRestaurantCart(params.restaurantId));
    const cartItems = [...theCart];

    cartItems.forEach((item, index) => {
      console.log(
        "IndideCartOutRestaurantID",
        params.restaurantId + " " + index
      );
      if (item.id === Number(params.restaurantId)) {
        console.log("IndideCartRestaurantID", params.restaurantId);
        setTotal(calculateTotal(item));
        cartItems.splice(index, 1);
      }
    });

    addItemToCart(cartItems, params.restaurantId);

    setTimeout(() => {
      setPaymentDone(false);
      navigate("/");
    }, 3500);
  }

  const handleSubmit = (e) => {
    e.preventDefault();
    // Perform checkout logic here
    console.log("Checkout submitted:", { name, email, address });
  };

  function handleOnRegister() {
    dispatch(uiActions.toggleSignup());
  }

  function handleOnLogin() {
    dispatch(uiActions.toggleLogin());
  }

  return (
    <>
      <div className="checkout">
        <div className="checkout__container">
          <div className="checkout__container-user-details">
            <h2>User Details</h2>

            {!isLoggedIn && (
              <div className="authentication">
                <p>Not logged in please log in to place an order!</p>
                <div className="authentication-buttons">
                  <div onClick={handleOnRegister} className="checkout-button">
                    <button>Register</button>
                  </div>
                  <div
                    onClick={handleOnLogin}
                    className="checkout-button-light"
                  >
                    <button>Login</button>
                  </div>
                </div>
              </div>
            )}

            {isLoggedIn && (
              <>
                <div className="checkout__container-input">
                  <label htmlFor="name">Name</label>
                  <input
                    ref={nameRef}
                    placeholder="Name"
                    type="text"
                    id="name"
                    value={name}
                    onChange={handleNameChange}
                  />
                </div>
                <div className="checkout__container-input">
                  <label htmlFor="email">Email</label>
                  <input
                    ref={emailRef}
                    placeholder="Email"
                    type="email"
                    id="email"
                    value={email}
                    onChange={handleEmailChange}
                  />
                </div>
                <div className="checkout__container-input">
                  <label htmlFor="address">Phone</label>
                  <input
                    ref={phoneRef}
                    placeholder="Phone"
                    type="text"
                    id="phone"
                    value={number}
                    onChange={handleNumberChange}
                  />
                </div>
              </>
            )}
          </div>

          <div className="checkout__container-pickup-details">
            <h2>Pickup Address</h2>
            <p>{data && data.address}</p>
          </div>

          <div className="checkout_container-payment-details">
            <h2>Payment Details</h2>
            <div className="payment-cards">
              <div onClick={handleOnCardClick} className="payment-details">
                <div className="credit-card">
                  <input ref={cardRef} checked={isCard} type="radio"></input>
                </div>
                <div className="payment-credit-card">
                  <p>Credit card</p>
                  <div className="payment-credit-card__container">
                    <svg
                      viewBox="0 0 160 100"
                      xmlns="http://www.w3.org/2000/svg"
                      xmlnsSketch="http://www.bohemiancoding.com/sketch/ns"
                    >
                      <g id="Page-1" fill="none" fill-rule="evenodd">
                        <g id="Master" transform="translate(-1)">
                          <path
                            id="Rectangle-1"
                            d="m149 .00000101c-8 .00000076-92.6992188-.00000261-140 0-4 .00000022-8 4-8 8v79.99999999c-.00000046 8 4 12 12 12 44.6232096 0 128 .000001 136 0 8 0 12-4 12-12v-76c0-7.99999999-4-11.99999999-12-11.99999999zm0 0"
                            fill="#265697"
                          />
                          <path
                            id="path2268"
                            d="m150.545235 50.5c.006577 23.2377654-18.625638 42.0792737-41.615705 42.0854469-22.9905367.0056984-41.6307381-18.8263128-41.6368454-42.0640782v-.0213687c-.0061074-23.2372905 18.6261073-42.0797486 41.6152344-42.08592179 22.990537-.00617318 41.631209 18.82678769 41.637316 42.06455309zm0 0"
                            fill="#dfac16"
                          />
                          <path
                            id="path1350"
                            d="m52.8125503 8.425c-22.8538255.14673184-41.358255 18.9402793-41.358255 42.075 0 23.2249441 18.6486577 42.0745251 41.6265101 42.0745251 10.7842282 0 20.6142953-4.1540782 28.0112751-10.9626257-.0004698 0-.0014094-.0009497-.0032886-.0018994h.0089262c1.5146309-1.3951397 2.9273155-2.9004469 4.2258389-4.5054749h-8.528255c-1.1387919-1.390391-2.1737584-2.8391899-3.1034899-4.3340502h14.7084564c.8944966-1.4468995 1.7044295-2.9493576 2.4232214-4.5054749h-19.5600671c-.6666443-1.4445251-1.2454362-2.9218156-1.7396644-4.4204749h23.0412752c1.3887248-4.1939664 2.1422818-8.6809217 2.1422818-13.345 0-3.0922905-.3316778-6.1071787-.9593288-9.01h-25.4461745c.3152349-1.4939106.7131543-2.9697765 1.187651-4.42h23.0497315c-.5153691-1.543296-1.1138926-3.0471787-1.7946308-4.505h-19.48349c.7028188-1.5176536 1.4991275-2.9939944 2.3884564-4.4195251h14.697651c-.9781208-1.5751117-2.0605369-3.0799441-3.2308054-4.5054749h-8.1946979c1.2670469-1.5072067 2.6618791-2.9265642 4.1760402-4.25-7.3974496-6.8094972-17.2303355-10.9645251-28.0169127-10.9645251-.0897316 0-.1785235-.00047486-.2682551 0 0 0 .0897316-.00047486 0 0zm0 0"
                            fill="#bf3126"
                          />
                          <g fill="#fff">
                            <path
                              id="path4157"
                              d="m68.0495302 61.2123743.5548322-3.807905c-.3030201 0-.748859.1310614-1.1420805.1310614-1.5428188 0-1.7128859-.8291061-1.614698-1.4421508l1.2463758-7.7696648h2.3447651l.5661074-4.2120112h-2.2108725l.4500671-2.6193296h-4.4320805c-.0977181.098771-2.6163087 14.7315922-2.6163087 16.5132682 0 2.6378491 1.465302 3.8126536 3.5314765 3.7936592 1.6179866-.013771 2.8779866-.4663129 3.3224161-.5869274 0 0-.4444295.1206145 0 0zm0 0"
                            />
                            <path
                              id="path4155"
                              d="m69.4537584 53.9522346c0 6.330838 4.1342282 7.8351956 7.6563087 7.8351956 3.2510067 0 4.6815436-.734609 4.6815436-.734609l.7808054-4.3207542s-2.4730201 1.1012012-4.7064429 1.1012012c-4.7590604 0-3.9256376-3.5866202-3.9256376-3.5866202h9.0069798s.5816108-2.9028212.5816108-4.0856983c0-2.9517318-1.4535571-6.548324-6.3197316-6.548324-4.45651.0009497-7.7554362 4.8544972-7.7554362 10.3396089zm7.772349-6.3275139c2.501208 0 2.0398658 2.8410894 2.0398658 3.0709218h-4.9206712c0-.2934637.4651007-3.0709218 2.8808054-3.0709218zm0 0"
                            />
                            <path
                              id="path4151"
                              d="m105.291879 61.2104749.79302-4.8839386s-2.174698 1.1021509-3.667248 1.1021509c-3.1438926 0-4.4048322-2.4265364-4.4048322-5.0335196 0-5.2885196 2.7051002-8.1979888 5.7165102-8.1979888 2.258322 0 4.070805 1.281648 4.070805 1.281648l.72349-4.7452793s-2.687718-1.0993017-4.991611-1.0993017c-5.1165768 0-10.0940935 4.4864805-10.0940935 12.9124022 0 5.5872067 2.6877181 9.2773464 7.9767115 9.2773464 1.495369.0004749 3.877248-.6135195 3.877248-.6135195zm0 0"
                            />
                            <path
                              id="path4149"
                              d="m43.6730872 43.6824302c-3.0391275 0-5.368859.9872346-5.368859.9872346l-.6431544 3.8591899s1.9228859-.7896927 4.8295302-.7896927c1.6504027 0 2.8577853.1875698 2.8577853 1.5432961 0 .8234078-.1479866 1.1273184-.1479866 1.1273184s-1.3018121-.1101676-1.9045638-.1101676c-3.8330872 0-7.8597315 1.6534637-7.8597315 6.6385475 0 3.9280447 2.6416778 4.8293296 4.2789262 4.8293296 3.1269798 0 4.4748322-2.0509218 4.5467114-2.0570949l-.1461074 1.7118715h3.9026174l1.7410739-12.3373464c0-5.2339106-4.5171141-5.402486-6.0862417-5.402486zm.9494631 10.0451955c.0845638.7536034-.4674496 4.2860894-3.135906 4.2860894-1.3765101 0-1.7344966-1.0627374-1.7344966-1.6914525 0-1.2260894.6591275-2.6981565 3.9068456-2.6981565.7554362.0009498.8362416.0826257.963557.1035196 0 0-.1273154-.0208939 0 0zm0 0"
                            />
                            <path
                              id="path4145"
                              d="m53.9071812 61.6772626c.9983222 0 6.7054362.2564246 6.7054362-5.6959498 0-5.5648882-5.2828859-4.4655865-5.2828859-6.701229 0-1.1130726.861141-1.4635196 2.4349665-1.4635196.6248322 0 3.0287919.200866 3.0287919.200866l.5590604-3.9555866c0 .0004748-1.5559731-.3518715-4.0891275-.3518715-3.2787248 0-6.6067785 1.3229609-6.6067785 5.8493296 0 5.1289665 5.5492617 4.6142179 5.5492617 6.7748324 0 1.4421508-1.5503355 1.5594413-2.7450335 1.5594413-2.0675839 0-3.929396-.7170391-3.9359732-.6828491l-.5910067 3.9156983c.1071141.0332402 1.255302.550838 4.9732886.550838zm0 0"
                            />
                            <path
                              id="path4139"
                              d="m142.004295 40.1328492-.95604 5.9960614s-1.668255-2.3291899-4.279866-2.3291899c-4.060939 0-7.445839 4.9489944-7.445839 10.6354469 0 3.6706704 1.805437 7.2672626 5.496175 7.2672626 2.654832 0 4.126711-1.8709498 4.126711-1.8709498l-.194966 1.5979051h4.310872l3.385839-21.3036592zm-2.058188 11.6910614c0 2.3662291-1.158993 5.5268995-3.562013 5.5268995-1.594966 0-2.342416-1.353352-2.342416-3.4774023 0-3.4731285 1.543288-5.7648044 3.490604-5.7648044 1.595436-.0004749 2.413825 1.1073743 2.413825 3.7153072zm0 0"
                            />
                            <path
                              id="path4133"
                              d="m19.675302 61.447905 2.6980537-16.0835195.3960403 16.0835195h3.0536912l5.6963088-16.0835195-2.5232886 16.0835195h4.5373154l3.4943624-21.3321508h-7.0164429l-4.3695973 13.0885754-.2273826-13.0885754h-6.4677181l-3.5446309 21.3321508zm0 0"
                            />
                            <path
                              id="path4131"
                              d="m87.9614765 61.4773464c1.2900671-7.415419 1.5291946-13.4366481 4.6077852-12.3344972.5388591-2.8700559 1.0589262-3.9802794 1.6471141-5.1949721 0 0-.2757718-.0584078-.8545637-.0584078-1.9848993 0-3.4553691 2.7408938-3.4553691 2.7408938l.3951006-2.5172346h-4.1267114l-2.7647651 17.3642179zm0 0"
                            />
                            <path
                              id="path4149_1_"
                              d="m115.51855 43.6824302c-3.039127 0-5.368859.9872346-5.368859.9872346l-.642684 3.8591899s1.922886-.7896927 4.82953-.7896927c1.650403 0 2.856846.1875698 2.856846 1.5432961 0 .8234078-.147047 1.1273184-.147047 1.1273184s-1.301813-.1101676-1.905034-.1101676c-3.832617 0-7.859262 1.6534637-7.859262 6.6385475 0 3.9280447 2.641208 4.8293296 4.278457 4.8293296 3.12698 0 4.474832-2.0509218 4.546241-2.0570949l-.145168 1.7118715h3.902618l1.740604-12.3373464c.00047-5.2339106-4.517114-5.402486-6.086242-5.402486zm.950873 10.0451955c.084564.7536034-.46792 4.2860894-3.137316 4.2860894-1.37651 0-1.733557-1.0627374-1.733557-1.6914525 0-1.2260894.659128-2.6981565 3.906376-2.6981565.755436.0009498.835772.0826257.964497.1035196 0 0-.128725-.0208939 0 0zm0 0"
                            />
                            <path
                              id="path4131_1_"
                              d="m125.171738 61.4773464c1.290537-7.415419 1.529665-13.4366481 4.607316-12.3344972.539798-2.8700559 1.060335-3.9802794 1.648053-5.1949721 0 0-.275771-.0584078-.854563-.0584078-1.9849 0-3.45537 2.7408938-3.45537 2.7408938l.395101-2.5172346h-4.126711l-2.764765 17.3642179zm0 0"
                            />
                          </g>
                        </g>
                      </g>
                    </svg>
                    <svg
                      viewBox="0 0 160 100"
                      xmlns="http://www.w3.org/2000/svg"
                      xmlnsSketch="http://www.bohemiancoding.com/sketch/ns"
                    >
                      <g id="Page-1" fill="none" fill-rule="evenodd">
                        <g id="american-express" transform="translate(-1)">
                          <path
                            id="Rectangle-1"
                            d="m149 .00000101c-8 .00000076-92.6992188-.00000261-140 0-4 .00000022-8 4-8 8v79.99999999c-.00000046 8 4 12 12 12 44.6232096 0 128 .000001 136 0 8 0 12-4 12-12v-76c0-7.99999999-4-11.99999999-12-11.99999999zm0 0"
                            fill="#306fc5"
                          ></path>
                          <path
                            id="Shape"
                            d="m14.5198284 36.625336-3.0987822-7.5509964-3.08107159 7.5509964zm68.2657601-3.0068014c-.622156.3776355-1.3580025.3902043-2.2395329.3902043h-5.4999956v-4.2071224h5.5748372c.7889782 0 1.6122351.0354212 2.1469807.341643.587306.2759425.9506588.8632485.9506588 1.6745079 0 .8278273-.3456422 1.493974-.9329482 1.8007672 0 0 .587306-.3067932 0 0zm39.2363865 3.0068014-3.13306-7.5509964-3.115922 7.5509964zm-73.1390289 8.1731522h-4.6413175l-.0171393-14.8346198-6.5649163 14.8346198h-3.9751708l-6.5820556-14.84776v14.84776h-9.2083649l-1.7396371-4.224833h-9.42660512l-1.75734771 4.224833h-4.91726l8.10745169-18.9411918h6.72659684l7.7001081 17.933402v-17.933402h7.3893158l5.9250497 12.8493197 5.4428647-12.8493197h7.5378562v18.9411918zm18.498427 0h-15.1242737v-18.9411918h15.1242737v3.9443201h-10.5966467v3.414145h10.3424141v3.8826186h-10.3424141v3.7826396h10.5966467zm21.3246947-13.8399702c0 3.0199415-2.0155796 4.5801875-3.1901917 5.0486612.9906505.3770642 1.8367597 1.0432109 2.2395328 1.5950958.6392952.9420892.749558 1.783628.749558 3.4752751v3.7209381h-4.5664761l-.0171392-2.3886446c0-1.1397622.10912-2.7788489-.7147081-3.6900874-.6615763-.6661467-1.6699374-.810688-3.2998831-.810688h-4.8601291v6.88942h-4.5270556v-18.9411918h10.4132564c2.3138031 0 4.0185903.0611301 5.482285.9072393 1.4322726.8461092 2.2909507 2.0812802 2.2909507 4.1939823zm7.2453458 13.8399702h-4.6196078v-18.9411918h4.6196078zm53.5933924 0h-6.415805l-8.581638-14.2164631v14.2164631h-9.220363l-1.761918-4.224833h-9.404895l-1.709358 4.224833h-5.297752c-2.200684 0-4.98696-.4867556-6.564916-2.0949915-1.591097-1.608236-2.4189243-3.7866387-2.4189243-7.2310631 0-2.8091283.4947539-5.3771641 2.4406333-7.4064551 1.463695-1.5116846 3.755788-2.2086821 6.875709-2.2086821h4.383086v4.058582h-4.291105c-1.652227 0-2.585175.245663-3.483845 1.1220516-.771839.797548-1.301443 2.3052335-1.301443 4.2905336 0 2.029291.403345 3.4924144 1.244883 4.448215.696998.7495579 1.963591.9769391 3.155342.9769391h2.03329l6.380955-14.89575h6.783728l7.665258 17.9156915v-17.9156915h6.893419l7.95834 13.191534v-13.191534h4.637319zm-149.54423469 3.7203668h7.73552926l1.7442076-4.2071224h3.90489973l1.7396371 4.2071224h15.2202537v-3.2164719l1.3585738 3.2301833h7.901209l1.3585737-3.2781733v3.2644619h37.8252527l-.0177106-6.905988h.7318474c.5124645.0177106.6621476.0651293.6621476.9112385v5.9947495h19.5633477v-1.6076646c1.577957.8455379 4.032302 1.6076646 7.261914 1.6076646h8.230283l1.761347-4.2071224h3.9049l1.722497 4.2071224h15.860121v-3.9963092l2.401784 3.9963092h12.709349v-26.4173466h-12.577947v3.1199206l-1.761347-3.1199206h-12.906451v3.1199206l-1.617377-3.1199206h-17.433506c-2.918249 0-5.483428.4073436-7.555567 1.5425354v-1.5425354h-12.0306333v1.5425354c-1.3185821-1.1700417-3.1153502-1.5425354-5.1132191-1.5425354h-43.952546l-2.9490992 6.8231482-3.0285111-6.8231482h-13.8439693v3.1199206l-1.5208257-3.1199206h-11.80668l-5.4828563 12.5602372v13.8571094zm161.03897969 13.9479477h-8.251422c-.823828 0-1.371142.0308507-1.832189.3422143-.477615.3067932-.661576.7621268-.661576 1.3631442 0 .7147081.403344 1.2008924.990079 1.4111343.477614.166251.99065.2148123 1.744779.2148123l2.453774.0657006c2.476055.0611301 4.128853.4867556 5.136642 1.5248248.183391.1445412.293653.3067931.419913.469045zm0 12.4905374c-1.099771 1.6082359-3.242752 2.4234945-6.143861 2.4234945h-8.74332v-4.0625812h8.707898c.86382 0 1.468265-.1136906 1.83219-.469045.315362-.2930817.535316-.7187072.535316-1.2357422 0-.5518849-.219954-.9900792-.553027-1.2528815-.328503-.2890826-.806689-.4204838-1.595096-.4204838-4.251113-.1445412-9.554578.1314012-9.554578-5.8639196 0-2.7479982 1.744779-5.6405377 6.495788-5.6405377h9.018118v-3.7694994h-8.378823c-2.528616 0-4.365375.6055879-5.666247 1.5471058v-1.5471058h-12.393415c-1.981872 0-4.308244.491326-5.408586 1.5471058v-1.5471058h-22.131383v1.5471058c-1.761347-1.2705921-4.733299-1.5471058-6.105012-1.5471058h-14.5980982v1.5471058c-1.3934236-1.3494328-4.4922058-1.5471058-6.3809546-1.5471058h-16.3377349l-3.7386487 4.0460131-3.5015553-4.0460131h-24.405195v26.4356285h23.9458622l3.8523393-4.1099998 3.6289573 4.1099998 14.7603496.0131401v-6.2187028h1.4511259c1.9584486.0302794 4.2682525-.0485613 6.3061131-.9295204v7.1345118h12.1746033v-6.8899914h.5873061c.7495579 0 .8232568.0308507.8232568.7798373v6.1095828h36.9842851c2.348082 0 4.802427-.6010175 6.161572-1.6916472v1.6916472h11.731267c2.441205 0 4.825279-.3422144 6.639187-1.218603zm-18.059662-7.5687069c.881531.9123811 1.354004 2.0641408 1.354004 4.0140198 0 4.0757213-2.546326 5.9781816-7.112231 5.9781816h-8.818161v-4.0625812h8.78274c.858678 0 1.467694-.1136906 1.849328-.469045.311364-.2930817.534746-.7187072.534746-1.2357422 0-.5518849-.241664-.9900792-.552456-1.2528815-.346214-.2890826-.823828-.4204838-1.612235-.4204838-4.233974-.1445412-9.536297.1314012-9.536297-5.8639196 0-2.7479982 1.726497-5.6405377 6.472936-5.6405377h9.076392v4.0323017h-8.305125c-.823257 0-1.358573.0308507-1.813907.3422143-.495897.3067932-.679858.7621268-.679858 1.3631443 0 .714708.421055 1.2008923.99065 1.4111342.477615.166251.990651.2148123 1.761918.2148123l2.437206.0657006c2.457773.0599875 4.14485.4850417 5.17035 1.5236822 0 0-1.0255-1.0386405 0 0zm-40.853192-1.1700417c-.605588.3593536-1.354575.3902043-2.2355338.3902043h-5.4999956v-4.2551124h5.5748371c.8061173 0 1.6128063.0171393 2.1606923.3422144.586735.3067931.937519.8935279.937519 1.7042159s-.350784 1.4636947-.937519 1.8184778c0 0 .586735-.3547831 0 0zm2.734287 2.3577939c1.007789.3719224 1.831618 1.0386405 2.217823 1.5905254.639295.9249499.731847 1.7881984.750129 3.4581358v3.755788h-4.545338v-2.3703627c0-1.1397623.109692-2.8274103-.731847-3.7083694-.661576-.6787155-1.669937-.8409674-3.3215928-.8409674h-4.8384193v6.9196995h-4.5493367v-18.9457623h10.4526768c2.292093 0 3.961459.1011217 5.447435.8940992 1.428845.8632485 2.327515 2.0458589 2.327515 4.2071224-.000572 3.0239406-2.017294 4.5670473-3.209045 5.0400915 0 0 1.191751-.4730442 0 0zm5.719378-10.1413131h15.110562v3.9180398h-10.601788v3.4444244h10.342985v3.8654794h-10.342985v3.7694994l10.601788.0171393v3.93118h-15.110562zm-30.5461996 8.743319h-5.8507796v-4.8247079h5.9033401c1.6345162 0 2.7691366.6661468 2.7691366 2.322944 0 1.6385154-1.08206 2.5017639-2.8216971 2.5017639zm-10.3601246 8.4793741-6.9511215-7.7172474 6.9511215-7.4721556zm-17.9511127-2.2252501h-11.1313923v-3.7694994h9.9396409v-3.8654794h-9.9396409v-3.4444244h11.3507751l4.9521099 5.5211341zm35.9936348-8.7558879c0 5.2629022-3.9266095 6.3495327-7.8840697 6.3495327h-5.6491074v6.3546745h-8.7998786l-5.5748371-6.2718346-5.7936487 6.2718346h-17.933402v-18.9457623h18.2093445l5.5702666 6.2101331 5.7587988-6.2101331h14.4666966c3.5929648 0 7.629837.9946496 7.629837 6.2415551zm0 0"
                            fill="#fff"
                          ></path>
                        </g>
                      </g>
                    </svg>
                    <svg
                      version="1.1"
                      id="fi_217425"
                      xmlns="http://www.w3.org/2000/svg"
                      xmlnsXlink="http://www.w3.org/1999/xlink"
                      x="0px"
                      y="0px"
                      viewBox="0 0 473.96 473.96"
                      xmlSpace="preserve"
                    >
                      <circle
                        fill="#F3F2F2"
                        cx="236.98"
                        cy="236.99"
                        r="236.97"
                      ></circle>
                      <g>
                        <polygon
                          fill="#293688"
                          points="175.483,282.447 193.616,175.373 222.973,175.373 204.841,282.447 	"
                        ></polygon>
                        <path
                          fill="#293688"
                          d="M309.352,178.141c-5.818-2.17-14.933-4.494-26.316-4.494c-29.014,0-49.451,14.526-49.627,35.337
		c-0.161,15.382,14.589,23.962,25.732,29.088c11.427,5.238,15.27,8.599,15.214,13.28c-0.071,7.177-9.13,10.458-17.571,10.458
		c-11.749-0.004-17.994-1.624-27.637-5.62l-3.783-1.706l-4.123,23.97c6.859,2.99,19.543,5.583,32.71,5.714
		c30.858-0.007,50.899-14.353,51.124-36.583c0.112-12.179-7.712-21.448-24.651-29.092c-10.264-4.947-16.55-8.251-16.482-13.272
		c0-4.449,5.324-9.208,16.815-9.208c9.601-0.15,16.557,1.931,21.979,4.101l2.627,1.235L309.352,178.141L309.352,178.141z"
                        ></path>
                        <path
                          fill="#293688"
                          d="M359.405,175.373c-7.034,0-12.116,2.148-15.207,9.119l-43.509,97.959h31.083l6.043-16.408h37.137
		l3.45,16.408h27.633L381.86,175.376h-22.454L359.405,175.373L359.405,175.373z M346.062,244.618
		c2.425-6.166,11.693-29.927,11.693-29.927c-0.168,0.281,2.413-6.196,3.895-10.215l1.987,9.227c0,0,5.616,25.56,6.795,30.918h-24.37
		V244.618z"
                        ></path>
                        <path
                          fill="#293688"
                          d="M121.946,248.771l-2.586-14.679c-5.358-17.111-21.987-35.625-40.621-44.901l25.938,93.256h31.09
		l46.626-107.074H151.31L121.946,248.771z"
                        ></path>
                      </g>
                      <g>
                        <path
                          fill="#F7981D"
                          d="M46.823,175.373v1.729c36.838,8.86,62.413,31.259,72.538,56.991l-10.645-49.582
		c-1.777-6.776-7.162-8.902-13.534-9.137L46.823,175.373L46.823,175.373z"
                        ></path>
                        <path
                          fill="#F7981D"
                          d="M236.964,473.958c91.464,0,170.77-51.846,210.272-127.725H26.696
		C66.201,422.112,145.504,473.958,236.964,473.958z"
                        ></path>
                      </g>
                      <path
                        fill="#293688"
                        d="M236.964,0C146.952,0,68.663,50.184,28.548,124.103h416.84C405.268,50.188,326.976,0,236.964,0z"
                      ></path>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                      <g></g>
                    </svg>
                  </div>
                </div>
              </div>

              <div onClick={handleOnPayPal} className="payment-details">
                <div className="credit-card">
                  <input
                    ref={paypalRef}
                    checked={isPaypal}
                    type="radio"
                  ></input>
                </div>
                <div className="payment-credit-card">
                  <p>PayPal</p>
                  <div className="payment-credit-card__container">
                    <svg
                      viewBox="0 0 160 100"
                      xmlns="http://www.w3.org/2000/svg"
                      xmlnsSketch="http://www.bohemiancoding.com/sketch/ns"
                      id="fi_11041080"
                    >
                      <g id="Page-1" fill="none" fill-rule="evenodd">
                        <g id="Paypal" transform="translate(-1)">
                          <path
                            id="Rectangle-1"
                            d="m149 .00000101c-8 .00000076-92.6992188-.00000261-140 0-4 .00000022-8 4-8 8v79.99999999c-.00000046 8 4 12 12 12 44.6232096 0 128 .000001 136 0 8 0 12-4 12-12v-76c0-7.99999999-4-11.99999999-12-11.99999999zm0 0"
                            fill="#f6f6f6"
                          ></path>
                          <path
                            id="pal"
                            d="m152.76461 33.4570312h-4.200372c-.002368 0-.004737.0007686-.006315.0007686l-.002369-.0007686c-.961483 0-1.937176.7170848-2.209517 1.6293887-.011051.0368918-.029997.0722465-.03868.1106755 0 0-.100253.4450075-.27392 1.2143557l-5.769691 25.4630406c-.133407.5756661-.222609.9507329-.249448 1.0483425l.011051.0138344c-.199717.8900152.349702 1.6263144 1.251981 1.7085524l.011841.0169087h4.35983c.955168 0 1.924546-.7101675 2.20557-1.6109427.01342-.043809.034734-.0845438.044996-.1283528l6.293849-27.727276-.009473-.0030743c.213926-.9484272-.413643-1.7354527-1.419333-1.7354527zm-21.544777 25.0254905c-.582574.3573895-1.198302.6632842-1.843238.9238326-.866756.3404808-1.688517.5187912-2.448704.5187912-1.166726 0-2.063479-.1606331-2.669735-.5041882-.607045-.3258777-.925171-.8923208-.914909-1.7031722 0-.9361299.22182-1.6624376.681248-2.2319551.462586-.5479972 1.150149-.9891619 2.002696-1.3181139.84781-.279763 1.890602-.5103368 3.094429-.6755814 1.07042-.1314271 3.186789-.3689182 3.457552-.3704554.270762-.0023057.450744-.1475673.329967.5549145-.053679.305126-.664671 2.7476719-.944906 3.8582693-.081308.332795-.536.8177687-.7444.9476586 0 0 .2084-.1298899 0 0zm8.306017-17.1669929c-1.782454-.9684103-4.570599-1.4579954-8.385746-1.4579954-1.886655 0-3.782782.1475672-5.685225.435016-1.39644.2082851-1.54011.2428711-2.407655.4265616-1.784823.3781412-2.060322 2.1182053-2.060322 2.1182053l-.573101 2.2949785c-.325231 1.467987.533631 1.4072692.916488 1.2935194.779133-.2290367 1.20146-.4565362 2.791302-.8070085 1.519586-.3358693 3.125216-.5871948 4.406404-.5772032 1.878761 0 3.307566.2005992 4.257209.5864262.950432.4035042 1.420911 1.0906143 1.420911 2.0736276.003158.2336482.009473.4542305-.07736.647144-.078151.1798476-.228136.3535466-.677302.4127272-2.681575.1552531-4.606121.3935127-6.923786.7224648-2.286878.3135804-4.287995.8508176-5.960723 1.5948026-1.783244.7701167-3.117322 1.8007819-4.036968 3.1065985-.895174 1.3119653-1.345129 2.9006193-1.347498 4.7721105 0 1.7685015.65283 3.2111254 1.915863 4.3309458 1.278031 1.1052174 2.940497 1.652446 4.951876 1.652446 1.256718-.0084544 2.240304-.096841 2.945234-.2682343.697826-.1713932 1.458803-.4150329 2.262407-.7539765.60073-.2444083 1.248823-.5979549 1.933229-1.0414253.685195-.4450076 1.159622-.7608938 1.768246-1.1490264l.022103.0368918-.171299.7355306c-.00079.0069172-.011052.0107601-.011052.0176773l.005526.0138345c-.19577.8861722.351281 1.62324 1.25277 1.7100895l.011052.0153716h.079729l.003157.0038429c.598362 0 2.652369-.0007686 3.612273-.0038429h.670197c.044206 0 .048942-.0130659.066309-.0230574.920435-.1099069 1.802979-.8400575 2.01059-1.7162382l3.428343-14.4070237c.07894-.3389436.141302-.7301506.178404-1.1805382.042627-.4549991.093148-.8292973.07815-1.0998373.007894-2.0390416-.892017-3.5462261-2.669735-4.5154049zm-20.644473-3.2816063c-.584942-1.1082917-1.468275-2.0006126-2.585269-2.6954085-1.145413-.6932588-2.50633-1.1766953-4.081963-1.458764-1.558267-.2659285-3.410977-.4181073-5.52182-.4227188l-9.8216565.0046115c-1.0112153.0169088-2.0034852.7900998-2.2371462 1.7423699l-6.6032915 27.9778329c-.2407655.9507329.4160113 1.7431384 1.4090706 1.7377584l4.7126898-.0084544c.9993744.0084544 2.0176943-.7785711 2.2537235-1.729304l1.5929997-6.7896318c.2233989-.9515015 1.2393506-1.7485185 2.2553026-1.734684h1.339603c5.748377 0 10.205303-1.149795 13.396828-3.4386249 3.183631-2.3003587 4.786103-5.317802 4.786103-9.0707759-.010262-1.6386117-.296812-3.0189805-.895174-4.1142064zm-10.132678 9.1507082c-1.406702.9960791-3.38098 1.4956558-5.921254 1.4956558h-1.168305c-1.010426.0115287-1.6632556-.7839512-1.423279-1.7377584l1.408281-5.9380456c.209979-.9392042 1.235403-1.738527 2.23162-1.7308412l1.543268-.0076858c1.8014.0076858 3.148898.3012832 4.079595.8846351.914909.5902691 1.358549 1.5056473 1.365654 2.7253831.003947 1.8591939-.702562 3.2895205-2.11558 4.308657"
                            fill="#306fc5"
                          ></path>
                          <path
                            id="pay"
                            d="m85.8355974 39.8576594c-.8943152 0-2.0673141.7089103-2.6225757 1.5656536 0 0-5.9822242 10.0457618-6.5697767 11.0496504-.3193982.539762-.6430083.1966522-.6970604-.0041256-.0435224-.2440962-1.8539139-10.9795157-1.8539139-10.9795157-.2035725-.8643068-1.1252646-1.6062217-2.2779063-1.6027838l-3.730291.0055008c-.8992289 0-1.4601063.7054724-1.2600437 1.5580901 0 0 2.8514193 15.8311855 3.4073829 19.554512.2772798 2.0593468-.028781 2.4244597-.028781 2.4244597l-3.6965962 6.3134966c-.5412221.8560557-.244989 1.5574025.6500281 1.5574025l4.3227572-.003438c.8950172 0 2.0806516-.6979088 2.61345-1.5553397l16.6297692-27.5498658s1.5906736-2.3536374.1235475-2.3336971c-1.0003133.0137519-5.00999 0-5.00999 0zm-31.2215388 18.6248623c-.5825737.3573895-1.1975126.661747-1.8424485.9230641-.8667561.3389435-1.6924635.5187912-2.450283.5187912-1.1635686 0-2.0626898-.1614018-2.6697348-.5034197-.6062556-.3266463-.9259607-.8930894-.9156985-1.7047094 0-.9338242.2241882-1.6624376.6828269-2.2311865.463375-.5487658 1.1477807-.990699 2.0003276-1.3188825.8501787-.2813001 1.8961275-.5087996 3.0960083-.6740442 1.07042-.1314271 3.1891569-.3681496 3.4591301-.3719925.2683944-.0007686.4491659-.1475673.3283884.5549144-.0521001.3051261-.6638814 2.7492091-.9441167 3.8590379-.0844653.3343321-.539157.8193058-.7443998.9484272 0 0 .2052428-.1291214 0 0zm8.3060171-17.1677615c-1.7824545-.9684102-4.5698092-1.4572268-8.3849566-1.4572268-1.8874441 0-3.7827822.1460301-5.6860142.4342474-1.3988084.2067479-1.5393208.2421026-2.4076556.4257931-1.7856121.3796783-2.0603217 2.1182052-2.0603217 2.1182052l-.5731009 2.2965157c-.3244415 1.4672184.53521 1.4065006.9164879 1.2927509.7775543-.2290368 1.202249-.4557677 2.7920911-.8077772 1.5172177-.3343321 3.1252159-.584889 4.4048256-.5764346 1.8803396 0 3.3075663.1998307 4.2572088.5856576.9512213.4035043 1.4193327 1.0921515 1.4193327 2.0743962.0063151.2336482.0110515.4549991-.0734138.6463754-.0797289.1813848-.2312928.3543152-.6804587.4127272-2.6784182.1575589-4.6021745.3950499-6.923786.724002-2.2868781.3135804-4.2872057.8508176-5.9607237 1.594034-1.783244.7701167-3.1157432 1.802319-4.0338099 3.1073671-.8983318 1.3111967-1.3474977 2.8998507-1.3490765 4.7721105 0 1.7677329.6536193 3.2111254 1.9150729 4.3301772 1.2788204 1.1052174 2.939708 1.6532146 4.9510872 1.6532146 1.2575067-.0084544 2.2403038-.0983782 2.947602-.2682343.697036-.1729304 1.4588024-.4150329 2.2592492-.7539765.603098-.2444083 1.2496128-.5994921 1.9348079-1.0421939.6836163-.444239 1.160411-.7601252 1.771403-1.1482578l.0189455.0361232-.1712988.7347621c-.0015788.0069172-.0110515.0115287-.0110515.019983l.0071045.0115287c-.19577.888478.3497021 1.6247772 1.2519809 1.7100895l.0110516.0169088h.0789395l.0023682.00538c.5999404 0 2.6547363-.0030743 3.6122728-.00538h.6709859c.0449956 0 .0513107-.014603.0655199-.023826.922803-.1129812 1.8021894-.8415946 2.0121685-1.714701l3.4283437-14.4085609c.0773607-.338175.1405124-.729382.1752458-1.179001.0457849-.4573049.0955168-.8300659.0820971-1.0998374.0078939-2.0405787-.8935955-3.5477632-2.6705243-4.516942zm-21.4445357-3.2808377c-.5849419-1.1082917-1.4682752-2.0006126-2.5852695-2.6954085-1.1454126-.6932588-2.50633-1.1766953-4.081963-1.458764-1.5582663-.2659285-3.410977-.4181073-5.52182-.4227188l-9.821656.0046115c-1.0112154.0169088-2.0034853.7900998-2.2371463 1.7423699l-6.6032915 27.9778329c-.2407655.9507329.4160114 1.7431384 1.4090706 1.7377584l4.7126898-.0084544c.9993744.0084544 2.0176944-.7785711 2.2537235-1.729304l1.5929997-6.7896318c.2233989-.9515015 1.2393506-1.7485185 2.2553023-1.734684h1.3396038c5.7483764 0 10.2053022-1.149795 13.3968273-3.4386249 3.1836311-2.3003587 4.7861035-5.317802 4.7861035-9.0707759-.0102621-1.6386117-.2968126-3.0189805-.8951742-4.1142064zm-10.1326778 9.1507082c-1.4067024.9960791-3.38098 1.4956558-5.921254 1.4956558h-1.168305c-1.0104259.0115287-1.6632558-.7839512-1.4232797-1.7377584l1.4082812-5.9380456c.2099792-.9392042 1.2354036-1.738527 2.2316205-1.7308412l1.5432677-.0076858c1.8014001.0076858 3.1488978.3012832 4.0795948.8846351.9149092.5902691 1.3585493 1.5056473 1.3656539 2.7253831.0039469 1.8591939-.7025618 3.2895205-2.1155794 4.308657"
                            fill="#265697"
                          ></path>
                        </g>
                      </g>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div
            onClick={onPlaceOrder}
            className={`checkout-button ${checkout ? "" : "disable"}`}
          >
            <button>Place Order</button>
          </div>
        </div>

        <div className="checkout__cart-items-container">
          <h2>Your cart from</h2>
          <h1>{data && data.name}</h1>
          <ul className="checkout__cart-items">
            {cart.items &&
              cart.items.map((item, index) => (
                <CartItem key={item.id} cartItem={item} index={index} />
              ))}
          </ul>
        </div>
      </div>
      {paymentDone && (
        <div className={`payment-done ${paymentDone ? "animate-scale" : ""}`}>
          <div className="payment-done__container">
            <Lottie options={loaderOptions}></Lottie>
            <h3>Payment Successful!</h3>
            <h2>${total}</h2>
          </div>
        </div>
      )}
    </>
  );
};

export default Checkout;
